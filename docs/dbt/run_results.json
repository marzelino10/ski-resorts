{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.11.2", "generated_at": "2026-02-10T13:51:25.864969Z", "invocation_id": "ca930b02-693e-41ba-96e3-c85de5933664", "invocation_started_at": "2026-02-10T13:51:20.009043Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-10T13:51:24.231039Z", "completed_at": "2026-02-10T13:51:24.242385Z"}, {"name": "execute", "started_at": "2026-02-10T13:51:24.243459Z", "completed_at": "2026-02-10T13:51:24.243477Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.015651702880859375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ski_resorts_pipeline.bronze_resorts", "compiled": true, "compiled_code": "SELECT \n    *\nFROM \n    ski_db.staging.ski_resorts", "relation_name": "ski_db.bronze.bronze_resorts", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-10T13:51:24.239200Z", "completed_at": "2026-02-10T13:51:24.242967Z"}, {"name": "execute", "started_at": "2026-02-10T13:51:24.244379Z", "completed_at": "2026-02-10T13:51:24.244390Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01555013656616211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ski_resorts_pipeline.bronze_snow", "compiled": true, "compiled_code": "SELECT \n    *\nFROM \n    ski_db.staging.ski_snow", "relation_name": "ski_db.bronze.bronze_snow", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-10T13:51:24.258832Z", "completed_at": "2026-02-10T13:51:24.269710Z"}, {"name": "execute", "started_at": "2026-02-10T13:51:24.288028Z", "completed_at": "2026-02-10T13:51:24.288058Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.040715694427490234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "analysis.ski_resorts_pipeline.lat_long", "compiled": true, "compiled_code": "SELECT\n    COUNT(*)\nFROM\n    ski_db.bronze.bronze_resorts\nWHERE latitude IN (\n    SELECT latitude\n    FROM ski_db.bronze.bronze_snow\n);\n\nSELECT\n    COUNT(*)\nFROM\n    ski_db.bronze.bronze_resorts\nWHERE longitude IN (\n    SELECT longitude\n    FROM ski_db.bronze.bronze_snow\n)", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-10T13:51:24.265317Z", "completed_at": "2026-02-10T13:51:24.282794Z"}, {"name": "execute", "started_at": "2026-02-10T13:51:24.307620Z", "completed_at": "2026-02-10T13:51:24.307641Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.058710336685180664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "analysis.ski_resorts_pipeline.snow_month", "compiled": true, "compiled_code": "SELECT\n    MIN(month),\n    MAX(month),\n    COUNT(DISTINCT(month))\nFROM\n    ski_db.bronze.bronze_snow", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-10T13:51:24.270179Z", "completed_at": "2026-02-10T13:51:24.302703Z"}, {"name": "execute", "started_at": "2026-02-10T13:51:24.310987Z", "completed_at": "2026-02-10T13:51:24.310998Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.05850863456726074, "adapter_response": {}, "message": null, "failures": null, "unique_id": "analysis.ski_resorts_pipeline.total_slopes_lifts", "compiled": true, "compiled_code": "WITH a AS ( \n    SELECT\n        resort_id,\n        beginner_slopes_km + intermediate_slopes_km + difficult_slopes_km AS calc_total_slopes,\n        total_slopes,\n        surface_lifts + chair_lifts + gondola_lifts AS calc_total_lifts,\n        total_lifts\n    FROM\n        ski_db.bronze.bronze_resorts)\n\nSELECT \n    *\nFROM a \nWHERE calc_total_lifts != total_lifts OR calc_total_slopes != total_slopes", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-10T13:51:24.278072Z", "completed_at": "2026-02-10T13:51:24.306526Z"}, {"name": "execute", "started_at": "2026-02-10T13:51:24.312366Z", "completed_at": "2026-02-10T13:51:24.312405Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.05484580993652344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ski_resorts_pipeline.silver_features", "compiled": true, "compiled_code": "WITH distinct_feature AS (\n    SELECT\n        DISTINCT\n            resort_id,\n            snow_cannons,\n            child_friendly AS is_child_friendly,\n            snowparks AS has_snowparks,\n            nightskiing AS has_nightskiing,\n            summer_skiing AS has_summer_skiing\n    FROM\n        ski_db.bronze.bronze_resorts\n)\n\nSELECT\n    ROW_NUMBER() OVER (ORDER BY resort_id) AS feature_id,\n    *\nFROM\n    distinct_feature", "relation_name": "ski_db.silver.silver_features", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-10T13:51:24.273589Z", "completed_at": "2026-02-10T13:51:24.307040Z"}, {"name": "execute", "started_at": "2026-02-10T13:51:24.313399Z", "completed_at": "2026-02-10T13:51:24.313410Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.05938315391540527, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ski_resorts_pipeline.silver_countries", "compiled": true, "compiled_code": "\n\nWITH distinct_country AS (\n    SELECT\n        DISTINCT\n        \n        \n    TRIM(\n        REGEXP_REPLACE(country, '[\\?\ufffd]', '') \n        )\n AS country , \n        \n        \n    TRIM(\n        REGEXP_REPLACE(continent, '[\\?\ufffd]', '') \n        )\n AS continent \n        \n    FROM \n        ski_db.bronze.bronze_resorts\n)\n\nSELECT\n    ROW_NUMBER() OVER (ORDER BY country, continent) AS country_id,\n    country, \n    continent\nFROM\n    distinct_country", "relation_name": "ski_db.silver.silver_countries", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-10T13:51:24.280621Z", "completed_at": "2026-02-10T13:51:24.308365Z"}, {"name": "execute", "started_at": "2026-02-10T13:51:24.315530Z", "completed_at": "2026-02-10T13:51:24.315621Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.057462453842163086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ski_resorts_pipeline.silver_lifts", "compiled": true, "compiled_code": "WITH distinct_lift AS (\n    SELECT\n        DISTINCT\n            resort_id,\n            surface_lifts,\n            chair_lifts,\n            gondola_lifts,\n            lift_capacity\n    FROM\n        ski_db.bronze.bronze_resorts\n)\n\nSELECT\n    ROW_NUMBER() OVER (ORDER BY resort_id) AS lift_id,\n    *\nFROM distinct_lift", "relation_name": "ski_db.silver.silver_lifts", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-10T13:51:24.285686Z", "completed_at": "2026-02-10T13:51:24.310356Z"}, {"name": "execute", "started_at": "2026-02-10T13:51:24.316836Z", "completed_at": "2026-02-10T13:51:24.316845Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.054102420806884766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ski_resorts_pipeline.silver_terrains", "compiled": true, "compiled_code": "WITH distinct_terrain AS (\n    SELECT\n        DISTINCT\n            resort_id,\n            lowest_point AS lowest_point_m,\n            highest_point AS highest_point_m,\n            longest_run AS longest_run_km\n    FROM\n        ski_db.bronze.bronze_resorts\n)\n\nSELECT\n    ROW_NUMBER() OVER (ORDER BY resort_id) AS terrain_id,\n    *\nFROM\n    distinct_terrain", "relation_name": "ski_db.silver.silver_terrains", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-10T13:51:24.283278Z", "completed_at": "2026-02-10T13:51:24.311724Z"}, {"name": "execute", "started_at": "2026-02-10T13:51:24.318230Z", "completed_at": "2026-02-10T13:51:24.318240Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.05604863166809082, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ski_resorts_pipeline.silver_slopes", "compiled": true, "compiled_code": "WITH distinct_slope AS (    \n    SELECT\n        DISTINCT\n            resort_id,\n            beginner_slopes AS beginner_slopes_km,\n            intermediate_slopes AS intermediate_slopes_km,\n            difficult_slopes AS difficult_slopes_km\n    FROM\n        ski_db.bronze.bronze_resorts\n)\n\nSELECT\n    ROW_NUMBER() OVER (ORDER BY resort_id) AS slope_id,\n    *\nFROM\n    distinct_slope", "relation_name": "ski_db.silver.silver_slopes", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-10T13:51:24.303298Z", "completed_at": "2026-02-10T13:51:24.314036Z"}, {"name": "execute", "started_at": "2026-02-10T13:51:24.320406Z", "completed_at": "2026-02-10T13:51:24.320416Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.05613303184509277, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ski_resorts_pipeline.bronze_resorts_lat_long", "compiled": true, "compiled_code": "SELECT \n    *\nFROM\n    ski_db.bronze.bronze_resorts\nWHERE \n    latitude NOT BETWEEN -90 AND 90\n    AND longitude NOT BETWEEN -180 AND 180", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-10T13:51:24.288893Z", "completed_at": "2026-02-10T13:51:24.314509Z"}, {"name": "execute", "started_at": "2026-02-10T13:51:24.321176Z", "completed_at": "2026-02-10T13:51:24.321185Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.05739402770996094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ski_resorts_pipeline.accepted_values_bronze_resorts_continent__Asia__Europe__Africa__North_America__South_America__Oceania.fd2097cf23", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        continent as value_field,\n        count(*) as n_records\n\n    from ski_db.bronze.bronze_resorts\n    group by continent\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Asia','Europe','Africa','North America','South America','Oceania'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-10T13:51:24.328709Z", "completed_at": "2026-02-10T13:51:24.348910Z"}, {"name": "execute", "started_at": "2026-02-10T13:51:24.368103Z", "completed_at": "2026-02-10T13:51:24.368119Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.05192255973815918, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ski_resorts_pipeline.bronze_snow_lat_long", "compiled": true, "compiled_code": "SELECT \n    *\nFROM\n    ski_db.bronze.bronze_snow\nWHERE \n    latitude NOT BETWEEN -90 AND 90\n    OR longitude NOT BETWEEN -180 AND 180\n    OR snow NOT BETWEEN 0 AND 100", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-10T13:51:24.336289Z", "completed_at": "2026-02-10T13:51:24.363933Z"}, {"name": "execute", "started_at": "2026-02-10T13:51:24.379270Z", "completed_at": "2026-02-10T13:51:24.379295Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.05749082565307617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ski_resorts_pipeline.not_null_bronze_resorts_continent.cacf5418e1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect continent\nfrom ski_db.bronze.bronze_resorts\nwhere continent is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-10T13:51:24.345015Z", "completed_at": "2026-02-10T13:51:24.368864Z"}, {"name": "execute", "started_at": "2026-02-10T13:51:24.381954Z", "completed_at": "2026-02-10T13:51:24.381963Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.05783200263977051, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ski_resorts_pipeline.not_null_bronze_resorts_latitude.45990239e1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect latitude\nfrom ski_db.bronze.bronze_resorts\nwhere latitude is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-10T13:51:24.349402Z", "completed_at": "2026-02-10T13:51:24.373240Z"}, {"name": "execute", "started_at": "2026-02-10T13:51:24.383624Z", "completed_at": "2026-02-10T13:51:24.383662Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.05845165252685547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ski_resorts_pipeline.not_null_bronze_resorts_longitude.0b93307216", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect longitude\nfrom ski_db.bronze.bronze_resorts\nwhere longitude is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-10T13:51:24.352970Z", "completed_at": "2026-02-10T13:51:24.378163Z"}, {"name": "execute", "started_at": "2026-02-10T13:51:24.385123Z", "completed_at": "2026-02-10T13:51:24.385132Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.05918383598327637, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ski_resorts_pipeline.not_null_bronze_resorts_resort.d20e4b4839", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect resort\nfrom ski_db.bronze.bronze_resorts\nwhere resort is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-10T13:51:24.360834Z", "completed_at": "2026-02-10T13:51:24.380035Z"}, {"name": "execute", "started_at": "2026-02-10T13:51:24.386981Z", "completed_at": "2026-02-10T13:51:24.386990Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.054563045501708984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ski_resorts_pipeline.not_null_bronze_snow_latitude.98082324f6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect latitude\nfrom ski_db.bronze.bronze_snow\nwhere latitude is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-10T13:51:24.357491Z", "completed_at": "2026-02-10T13:51:24.380538Z"}, {"name": "execute", "started_at": "2026-02-10T13:51:24.387777Z", "completed_at": "2026-02-10T13:51:24.387787Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.059629201889038086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ski_resorts_pipeline.not_null_bronze_resorts_resort_id.f18700d4d6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect resort_id\nfrom ski_db.bronze.bronze_resorts\nwhere resort_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-10T13:51:24.364611Z", "completed_at": "2026-02-10T13:51:24.383018Z"}, {"name": "execute", "started_at": "2026-02-10T13:51:24.389678Z", "completed_at": "2026-02-10T13:51:24.389688Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.05630826950073242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ski_resorts_pipeline.not_null_bronze_snow_longitude.5d8d70e017", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect longitude\nfrom ski_db.bronze.bronze_snow\nwhere longitude is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-10T13:51:24.369854Z", "completed_at": "2026-02-10T13:51:24.384558Z"}, {"name": "execute", "started_at": "2026-02-10T13:51:24.390502Z", "completed_at": "2026-02-10T13:51:24.390511Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.055535078048706055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ski_resorts_pipeline.not_null_bronze_snow_month.768670e27b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect month\nfrom ski_db.bronze.bronze_snow\nwhere month is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-10T13:51:24.373706Z", "completed_at": "2026-02-10T13:51:24.386360Z"}, {"name": "execute", "started_at": "2026-02-10T13:51:24.392099Z", "completed_at": "2026-02-10T13:51:24.392108Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.056577444076538086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ski_resorts_pipeline.not_null_bronze_snow_snow.d3dfb3a944", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect snow\nfrom ski_db.bronze.bronze_snow\nwhere snow is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-10T13:51:24.395321Z", "completed_at": "2026-02-10T13:51:24.407263Z"}, {"name": "execute", "started_at": "2026-02-10T13:51:24.408263Z", "completed_at": "2026-02-10T13:51:24.408275Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.01986384391784668, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ski_resorts_pipeline.unique_bronze_resorts_resort_id.f4dfab5f7d", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    resort_id as unique_field,\n    count(*) as n_records\n\nfrom ski_db.bronze.bronze_resorts\nwhere resort_id is not null\ngroup by resort_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-10T13:51:24.404477Z", "completed_at": "2026-02-10T13:51:24.409384Z"}, {"name": "execute", "started_at": "2026-02-10T13:51:24.409822Z", "completed_at": "2026-02-10T13:51:24.409831Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.01621103286743164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ski_resorts_pipeline.gold_beginner_expert_resort", "compiled": true, "compiled_code": "WITH base AS ( \n    SELECT \n        t.resort_id,\n        lowest_point_m,\n        highest_point_m,\n        beginner_slopes_km,\n        intermediate_slopes_km,\n        difficult_slopes_km,\n        TO_NUMBER(is_child_friendly) AS is_child_friendly,\n    FROM\n        ski_db.silver.silver_terrains AS t\n    JOIN\n        ski_db.silver.silver_slopes AS s\n        ON \n            t.resort_id = s.resort_id\n    JOIN \n        ski_db.silver.silver_features AS f\n        ON\n            t.resort_id = f.resort_id\n),\nmetrics AS (\n    SELECT\n        *,\n        highest_point_m - lowest_point_m AS vertical_drop_m,\n        ROUND(beginner_slopes_km / (beginner_slopes_km + intermediate_slopes_km + difficult_slopes_km), 2) AS beginner_slopes_ratio,\n        ROUND(intermediate_slopes_km / (beginner_slopes_km + intermediate_slopes_km + difficult_slopes_km), 2) AS intermediate_slopes_ratio,\n        ROUND(difficult_slopes_km / (beginner_slopes_km + intermediate_slopes_km + difficult_slopes_km), 2) AS difficult_slopes_ratio\n    FROM\n        base\n),\nbinary_metrics AS (\n    SELECT\n        *,\n        CASE\n            WHEN vertical_drop_m <= 600 THEN 1\n            ELSE 0\n            END AS low_vertical_drop,\n        CASE \n            WHEN vertical_drop_m >= 1000 THEN 1\n            ELSE 0\n            END AS high_vertical_drop,\n        CASE \n            WHEN highest_point_m >= 3000 THEN 1\n            ELSE 0\n            END AS high_peak\n    FROM\n        metrics\n),\nscoring AS (\n    SELECT\n        *,\n        (\n            0.6 * beginner_slopes_ratio +\n            0.2 * is_child_friendly +\n            0.2 * low_vertical_drop\n        ) AS beginner_score,\n        (\n            0.6 * difficult_slopes_ratio + \n            0.3 * high_vertical_drop + \n            0.1 * high_peak\n        ) AS expert_score\n    FROM\n        binary_metrics\n),\nfinal AS (\n    SELECT\n        resort_id,\n        beginner_score,\n        expert_score,\n        CASE \n            WHEN beginner_score >= 0.6 THEN 'Beginner'\n            WHEN expert_score >= 0.6 THEN 'Expert'\n            ELSE 'Intermediate'\n            END AS resort_overall_difficulty\n    FROM\n        scoring\n)\n\nSELECT * FROM final", "relation_name": "ski_db.gold.gold_beginner_expert_resort", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-10T13:51:24.401541Z", "completed_at": "2026-02-10T13:51:24.410613Z"}, {"name": "execute", "started_at": "2026-02-10T13:51:24.411011Z", "completed_at": "2026-02-10T13:51:24.411019Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.019542694091796875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ski_resorts_pipeline.silver_locations", "compiled": true, "compiled_code": "WITH distinct_countries AS (\n    SELECT\n        DISTINCT\n            country,\n            latitude,\n            longitude\n    FROM\n        ski_db.bronze.bronze_resorts\n),\ncountries_with_id AS (\n    SELECT\n        country_id,\n        latitude,\n        longitude\n    FROM\n        distinct_countries AS dc\n    LEFT JOIN\n        ski_db.silver.silver_countries AS cc\n    ON\n        dc.country = cc.country\n),\ndistinct_snow_locations AS (\n    SELECT\n        DISTINCT\n            latitude,\n            longitude\n    FROM\n        ski_db.bronze.bronze_snow\n),\ncombined_locations AS (\n    SELECT \n        *\n    FROM\n        countries_with_id\n    UNION\n    SELECT\n        NULL AS country_id,\n        latitude,\n        longitude\n    FROM\n        distinct_snow_locations\n)\n\n\nSELECT\n    ROW_NUMBER() OVER (ORDER BY country_id, latitude, longitude) AS location_id,\n    country_id,\n    latitude,\n    longitude,\n    ST_MAKEPOINT(longitude, latitude) AS geopoint\nFROM\n    combined_locations", "relation_name": "ski_db.silver.silver_locations", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-10T13:51:24.419398Z", "completed_at": "2026-02-10T13:51:24.422081Z"}, {"name": "execute", "started_at": "2026-02-10T13:51:24.422991Z", "completed_at": "2026-02-10T13:51:24.423002Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.008694648742675781, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ski_resorts_pipeline.silver_snow", "compiled": true, "compiled_code": "SELECT \n    month,\n    location_id,\n    snow AS snow_coverage_perc\nFROM\n    ski_db.bronze.bronze_snow AS s \nLEFT JOIN\n    ski_db.silver.silver_locations AS cl\nON \n    s.latitude = cl.latitude\nAND \n    s.longitude = cl.longitude\nWHERE cl.country_id IS NULL", "relation_name": "ski_db.silver.silver_snow", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-10T13:51:24.414913Z", "completed_at": "2026-02-10T13:51:24.422497Z"}, {"name": "execute", "started_at": "2026-02-10T13:51:24.423782Z", "completed_at": "2026-02-10T13:51:24.423791Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.0111846923828125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ski_resorts_pipeline.silver_resorts", "compiled": true, "compiled_code": "WITH flatten_seasons AS (\n    SELECT\n        resort_id,\n        TRIM(S.value::string) AS resort_season\n    FROM\n        ski_db.bronze.bronze_resorts,\n        LATERAL FLATTEN(input=> SPLIT(season, ',')) S\n)\n\nSELECT \n    r.resort_id,\n    \n    TRIM(\n        REGEXP_REPLACE(resort, '[\\?\ufffd]', '') \n        )\n AS resort,\n    location_id,\n    price AS euro_price,\n    MONTH(\n            TO_DATE(\n                CASE \n                    WHEN TRIM(LOWER(resort_season)) = 'year-round' THEN 'January'\n                    WHEN LOWER(resort_season) = 'unknown' THEN NULL\n                    ELSE TRIM(SPLIT_PART(resort_season, '-', 1)) \n                    END,\n                'MMMM')\n            ) AS season_start_month,\n        MONTH(\n            TO_DATE(\n                CASE \n                    WHEN TRIM(LOWER(resort_season)) = 'year-round' THEN 'December'\n                    WHEN LOWER(resort_season) = 'unknown' THEN NULL\n                    WHEN TRIM(SPLIT_PART(resort_season, '-', 2)) = '' THEN TRIM(SPLIT_PART(resort_season, '-', 1))\n                    ELSE TRIM(SPLIT_PART(resort_season, '-', 2)) \n                    END,\n                'MMMM')\n            ) AS season_end_month,\n    terrain_id,\n    slope_id,\n    lift_id,\n    feature_id\nFROM \n    ski_db.bronze.bronze_resorts AS r\nLEFT JOIN\n    flatten_seasons AS fs\n    ON r.resort_id = fs.resort_id\nLEFT JOIN\n    ski_db.silver.silver_locations AS cl\n    ON \n        r.latitude = cl.latitude\n    AND r.longitude = cl.longitude\nLEFT JOIN\n    ski_db.silver.silver_terrains AS ct\n    ON\n        r.resort_id = ct.resort_id\nLEFT JOIN\n    ski_db.silver.silver_slopes AS cs\n    ON\n        r.resort_id = cs.slope_id\nLEFT JOIN\n    ski_db.silver.silver_lifts AS cli\n    ON\n        r.resort_id = cli.resort_id\nLEFT JOIN\n    ski_db.silver.silver_features AS cf\n    ON\n        r.resort_id = cf.resort_id\nORDER BY \n    r.resort_id", "relation_name": "ski_db.silver.silver_resorts", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-10T13:51:24.428566Z", "completed_at": "2026-02-10T13:51:24.438836Z"}, {"name": "execute", "started_at": "2026-02-10T13:51:24.439866Z", "completed_at": "2026-02-10T13:51:24.439877Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.014208555221557617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ski_resorts_pipeline.gold_resort_overview", "compiled": true, "compiled_code": "SELECT\n    cr.resort_id,\n    resort,\n    country,\n    continent,\n    latitude,\n    longitude,\n    euro_price,\n    lowest_point_m,\n    highest_point_m,\n    is_child_friendly,\n    has_snowparks,\n    has_nightskiing,\n    has_summer_skiing,\nFROM\n    ski_db.silver.silver_resorts AS cr\nLEFT JOIN\n    ski_db.silver.silver_locations AS cl\n    ON \n        cr.location_id = cl.location_id\nLEFT JOIN\n    ski_db.silver.silver_countries AS cc\n    ON \n        cl.country_id = cc.country_id\nLEFT JOIN\n    ski_db.silver.silver_terrains AS ct\n    ON\n        cr.terrain_id = ct.terrain_id\nLEFT JOIN\n    ski_db.silver.silver_slopes AS cs\n    ON\n        cr.slope_id = cs.slope_id\nLEFT JOIN\n    ski_db.silver.silver_lifts AS cli\n    ON\n        cr.lift_id = cli.lift_id\nLEFT JOIN\n    ski_db.silver.silver_features AS cf\n    ON\n        cr.feature_id = cf.feature_id", "relation_name": "ski_db.gold.gold_resort_overview", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-10T13:51:24.433850Z", "completed_at": "2026-02-10T13:51:24.440512Z"}, {"name": "execute", "started_at": "2026-02-10T13:51:24.441239Z", "completed_at": "2026-02-10T13:51:24.441248Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.013252735137939453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ski_resorts_pipeline.gold_resort_season", "compiled": true, "compiled_code": "WITH calendar_months AS (\n    SELECT\n        SEQ2() + 1 AS calendar_month\n    FROM\n        TABLE(GENERATOR(ROWCOUNT => 12))\n)\n\nSELECT \n    DISTINCT(resort_id),\n    calendar_month,\n    CASE \n        WHEN season_start_month <= season_end_month AND calendar_month BETWEEN season_start_month AND season_end_month\n            THEN TRUE\n        WHEN season_start_month > season_end_month AND (calendar_month >= season_start_month OR calendar_month <= season_end_month)\n            THEN TRUE\n        ELSE FALSE\n        END AS is_operating_season,\n    season_start_month,\n    season_end_month\nFROM\n    ski_db.silver.silver_resorts\nCROSS JOIN calendar_months\nORDER BY\n    resort_id,\n    calendar_month", "relation_name": "ski_db.gold.gold_resort_season", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-10T13:51:24.436162Z", "completed_at": "2026-02-10T13:51:24.442037Z"}, {"name": "execute", "started_at": "2026-02-10T13:51:24.442417Z", "completed_at": "2026-02-10T13:51:24.442425Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.010253190994262695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ski_resorts_pipeline.gold_resort_snow_coverage", "compiled": true, "compiled_code": "WITH resort_geopoint AS (\n    SELECT    \n        resort_id,\n        resort,\n        geopoint\n    FROM \n        ski_db.silver.silver_resorts AS cr\n    LEFT JOIN\n        ski_db.silver.silver_locations AS cl\n    ON \n        cr.location_id = cl.location_id\n),\nsnow_geopoint AS (\n    SELECT\n        month,\n        snow_coverage_perc,\n        geopoint\n    FROM\n        ski_db.silver.silver_snow AS cs\n    LEFT JOIN\n        ski_db.silver.silver_locations AS cl\n    ON \n        cs.location_id = cl.location_id\n)\n\nSELECT\n    resort_id,\n    resort,\n    month,\n    AVG(snow_coverage_perc) AS avg_snow_coverage_per,\n    MAX(snow_coverage_perc) AS max_snow_coverage_per,\n    COUNT(snow_coverage_perc) AS snow_grid_used\nFROM\n    resort_geopoint AS rg\nJOIN\n    snow_geopoint AS sg\nON\n    ST_DISTANCE(rg.geopoint, sg.geopoint) <= 30000\nGROUP BY \n    month,\n    resort_id,\n    resort\nORDER BY \n    resort_id,\n    month", "relation_name": "ski_db.gold.gold_resort_snow_coverage", "batch_results": null}], "elapsed_time": 4.8057239055633545, "args": {"state_modified_compare_vars": false, "static_parser": true, "defer": false, "vars": {}, "validate_macro_args": false, "empty_catalog": false, "state_modified_compare_more_unrendered_values": false, "printer_width": 80, "require_unique_project_resource_names": false, "log_file_max_bytes": 10485760, "cache_selected_only": false, "require_all_warnings_handled_by_warn_error": false, "require_nested_cumulative_type_params": false, "show_all_deprecations": false, "profiles_dir": "/home/marzelino_unix/repos/ski-resorts/ski_resorts_pipeline", "upload_to_artifacts_ingest_api": false, "version_check": true, "log_path": "/home/marzelino_unix/repos/ski-resorts/ski_resorts_pipeline/logs", "require_batched_execution_for_custom_microbatch_strategy": false, "log_level": "info", "partial_parse": true, "print": true, "skip_nodes_if_on_run_start_fails": false, "static": false, "indirect_selection": "eager", "populate_cache": true, "require_ref_searches_node_package_before_root": false, "select": [], "show_resource_report": false, "write_json": true, "exclude": [], "log_level_file": "debug", "source_freshness_run_project_hooks": true, "introspect": true, "log_format_file": "debug", "quiet": false, "macro_debugging": false, "require_generic_test_arguments_property": true, "partial_parse_file_diff": true, "require_resource_names_without_spaces": true, "use_colors": true, "project_dir": "/home/marzelino_unix/repos/ski-resorts/ski_resorts_pipeline", "strict_mode": false, "which": "generate", "compile": true, "log_format": "default", "require_explicit_package_overrides_for_builtin_materializations": true, "warn_error_options": {"error": [], "warn": [], "silence": []}, "require_yaml_configuration_for_mf_time_spines": false, "favor_state": false, "invocation_command": "dbt docs generate", "use_fast_test_edges": false, "send_anonymous_usage_stats": true, "use_colors_file": true}}